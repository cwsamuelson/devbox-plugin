{
  "name": "CPP_TEST",
  "version": "0.0.2",
  "description": "C++ development plugin",
  "packages": {
    "gcc": "latest",
    "cmake": "latest",
    "ninja": "latest",
    "gitlab-ci-local": "latest",
    "cloc": "latest",
    "python": "latest",
    "doxygen": "latest",
    "mkdocs": "latest"
  },
  "env": {
    "CPP_TEST_DIR": "{{ .Virtenv }}",
    "SCRIPT_DIR": "{{ .Virtenv }}/scripts"
  },
  "create_files": {
    "{{ .Virtenv }}/scripts/build.bash": "scripts/build.bash",
    "{{ .Virtenv }}/scripts/clean.bash": "scripts/clean.bash",
    "{{ .Virtenv }}/docker/Dockerfile.builder": "docker/Dockerfile.builder",
    "{{ .Virtenv }}/docker/Dockerfile.runtime": "docker/Dockerfile.runtime"
  },
  "shell": {
    "init_hook": [
      "chmod u+x $SCRIPT_DIR/build.bash",
      "chmod u+x $SCRIPT_DIR/clean.bash",
      ". ${DEVBOX_PROJECT_ROOT}/.venv/bin/activate",
      "# the equals sign disambiguates from other packages that have 'conan' in them, like conan_server",
      "[ `python -m pip freeze | grep 'conan='` ] || (echo 'Installing conan...' ; python -m pip install conan)",
      "[ `python -m pip freeze | grep 'mkdoxy'` ] || (echo 'Installing conan...' ; python -m pip install mkdoxy)"
    ],
    "scripts": {
      "build": [
        "$SCRIPT_DIR/build.bash build $@"
      ],
      "test": [
        "echo \"Fuzzing. Mutation. etc?\""
      ],
      "line-report": [
        "cloc --vcs=git $@"
      ],
      "ci": [
        "gitlab-ci-local --volume personal_conan_cache:/root/.conan2 $@"
      ],
      "clean": [
        "scripts/clean.bash clean $@"
      ],
      "purge": [
        "devbox run clean purge $@"
      ],
      "reset": [
        "devbox run purge reset $@"
      ]
    }
  }
}

